jQuery(function(l){var n={message:null,overlayCSS:{background:"#000",opacity:.6},ignoreIfBlocked:!0},s=(l.fn.yith_wcmbs_downloads_by_product=function(){var t=l(this);t.find("#yith-wcmbs-reports-table-downloads").data("order");t.on("yith_wcmbs_update_table",".yith-wcmbs-reports-download-reports-table",function(t){var e=l(t.target).closest(".yith-wcmbs-reports-download-reports-table"),t=e.find(".yith-wcmbs-reports-table-downloads").first(),a=t.data("order"),t={user_id:t.data("user-id"),order:a,action:"yith_wcmbs_get_download_table_reports"};e.block(n),l.ajax({type:"POST",data:t,url:ajaxurl,success:function(t){e.html(t)},complete:function(){e.unblock()}})}).on("click",".yith-wcmbs-reports-filter-button",function(t){var t=l(t.target).closest("#yith-wcmbs-reports-downloads-content-downloads-by-product"),e=t.find(".yith-wcmbs-reports-filter-user-id").first(),t=t.find(".yith-wcmbs-reports-download-reports-table").first();t.find(".yith-wcmbs-reports-table-downloads").first().data("user-id",e.val()),t.trigger("yith_wcmbs_update_table")}).on("click",".yith-wcmbs-reports-filter-reset",function(t){var t=l(t.target).closest("#yith-wcmbs-reports-downloads-content-downloads-by-product"),e=t.find(".yith-wcmbs-reports-filter-user-id").first(),t=t.find(".yith-wcmbs-reports-filter-button").first();e.trigger("yith_wcmbs_select2_reset"),t.trigger("click")}).on("click",".yith-wcmbs-reports-table-downloads-order-by-downloads",function(t){var t=l(t.target),e=(t.closest("#yith-wcmbs-reports-downloads-content-downloads-by-product"),t.closest(".yith-wcmbs-reports-download-reports-table"));e.find(".yith-wcmbs-reports-table-downloads").first().data("order",t.data("order")),e.trigger("yith_wcmbs_update_table")})},l("#yith-wcmbs-download-reports-downloads-by-product").yith_wcmbs_downloads_by_product(),l(".yith-wcmbs-reports-downloads-menu")),d=l(".yith-wcmbs-reports-downloads-content-wrapper"),c=(l(s).on("click","a",function(t){t.preventDefault();var t=l(t.target).closest("a"),e=t.closest("li"),t=t.data("type");s.find("li").removeClass("yith-wcmbs-reports-downloads-menu-active"),e.addClass("yith-wcmbs-reports-downloads-menu-active"),l(".yith-wcmbs-reports-downloads-content").hide(),l("#yith-wcmbs-reports-downloads-content-"+t).show()}),l(s).on("click","span.close",function(t){t.preventDefault();var t=l(t.target).closest("span.close").closest("li"),e=t.find("a").first().data("type");t.is(".yith-wcmbs-reports-downloads-menu-active")&&s.find('a[data-type="downloads-by-user"]').trigger("click"),t.remove(),l("#yith-wcmbs-reports-downloads-content-"+e).remove()}),function(t,e){for(var a=t.split("&"),o=0;o<a.length;o++){var r=a[o].split("=");if(r[0]==e)return r[1]}return!1}),o=(l.fn.yith_wcmbs_ajax_table=function(){l(this).each(function(){var o,r=l(this),a=r.data("action"),n=r.find(".tablenav.top .tablenav-pages"),s=r.find(".tablenav.bottom .tablenav-pages"),d={message:null,overlayCSS:{background:"#000",opacity:.6},ignoreIfBlocked:!0},i=l.extend({paged:"1",order:"DESC",orderby:"ID",per_page:"10"},r.data());r.on("click",".tablenav-pages a, .manage-column.sortable a, .manage-column.sorted a",function(t){t.preventDefault();t=this.search.substring(1),t=l.extend(i,{paged:c(t,"paged")||i.paged,order:c(t,"order")||i.order,orderby:c(t,"orderby")||i.orderby,per_page:c(t,"per_page")||i.per_page});r.trigger("update",t)}),r.on("change","input[name=paged]",function(t){13==t.which&&t.preventDefault();var t=r.find(".tablenav-pages a")[0].search.substring(1),e=r.find("input[name=paged]"),a=l.extend(i,{paged:parseInt(e.val())||i.paged,order:c(t,"order")||i.order,orderby:c(t,"orderby")||i.orderby,per_page:c(t,"per_page")||i.per_page});window.clearTimeout(o),o=window.setTimeout(function(){r.trigger("update",a)},500)}),r.on("click",".yith-wcmbs-ajax-table-apply-button",function(){var t=r.find(".yith-wcmbs-ajax-table-per-page").val(),t=l.extend(i,{per_page:t||c(query,"per_page")||i.per_page,paged:"1"});r.trigger("update",t)}),r.on("update",function(t,e){r.block(d),l.ajax({url:ajaxurl,data:l.extend({_yith_wcmbs_ajax_table_nonce:r.find("#_yith_wcmbs_ajax_table_nonce").val(),action:a},e),success:function(t){t=l.parseJSON(t);t.rows.length&&r.find(".wp-list-table tbody").html(t.rows),t.column_headers.length&&r.find("thead tr, tfoot tr").html(t.column_headers),t.pagination.bottom.length&&n.html(l(t.pagination.top).html()),t.pagination.top.length&&s.html(l(t.pagination.bottom).html())},complete:function(){r.unblock(),r.find(".pagination-links").show(),r.find(".tips").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:0})}})})})},l(".yith-wcmbs-ajax-table").yith_wcmbs_ajax_table(),function(e,t,a){var o,r=s.find('a[data-type="downloads-by-user-'+e+'"]');r.length<1?(o=l('<li><a href="#" data-type="downloads-by-user-'+e+'">'+t+'</a> <span class="dashicons dashicons-no-alt close"></span> </li>'),s.append(o),t={action:"yith_wcmbs_get_download_reports_details_by_user_table",user_id:e},o.block(n),l.ajax({type:"POST",data:t,url:ajaxurl,success:function(t){d.append(t);t=d.find("#yith-wcmbs-reports-downloads-content-downloads-by-user-"+e);t.find(".yith-wcmbs-ajax-table").yith_wcmbs_ajax_table(),t.find(".yith-wcmbs-tabs").tabs(),t.find(".tips-top").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:0,defaultPosition:"top"})},complete:function(){o.unblock(),a||s.find('a[data-type="downloads-by-user-'+e+'"]').trigger("click")}})):a||r.trigger("click")}),r=(l(document).on("click",".yith_wcmbs_download_reports_by_user .report_actions a.details",function(t){t.preventDefault();var e=l(t.target).closest("a.details"),a=e.data("user_id"),e=e.data("user_name"),t=t.ctrlKey;o(a,e,t)}),l("#yith-wcmbs-download-reports-downloads-details-by-user-search-select"));l("#yith-wcmbs-download-reports-downloads-details-by-user-search-show-button").on("click",function(t){var e,a=r.val(),t=t.ctrlKey;a&&(e=(e=(e=!!(e=r.select2("data"))&&e[0])?e.text:"#"+a).substring(0,e.indexOf(" (")),console.log(a),console.log(e),console.log(t),o(a,e,t),r.val("").trigger("change"))})});